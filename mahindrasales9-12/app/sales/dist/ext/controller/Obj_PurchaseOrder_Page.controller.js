sap.ui.define(["sap/ui/core/mvc/ControllerExtension"],function(e){"use strict";var t;var s;var i;return e.extend("sales.ext.controller.Obj_PurchaseOrder_Page",{override:{onInit:function(){var e=this.base.getExtensionAPI().getModel()},editFlow:{onAfterSave:async function(e){},onBeforeSave:async function(e){}},routing:{onBeforeBinding:async function(e){debugger},onAfterBinding:async function(e){debugger;const n=this.base.getView().findAggregatedObjects(true,function(e){return e.isA("sap.m.Button")&&(e.getId().includes("release-so")||e.getId().includes("Edit")||e.getId().includes("Save"))});const g=this.base.getView().findAggregatedObjects(true,function(e){return e.isA("sap.m.Button")&&e.getId().includes("sync-delivery")});let a=e.getPath().match(/purchaseOrderUuid=([\w-]+).*IsActiveEntity=(\w+)/);if(a){i=a[1];var r=a[2]}let o=e.getModel().bindContext(`/statusFun(...)`);o.setParameter("purchaseEnquiryUuid",i).setParameter("state","PO");await o.execute();var l=o.getBoundContext().getValue();console.log(l);const u=this.base.getView();const d=u.getContent()[0];const m=d.getSections();const f=d.getAggregation("footer");const c=m[5].mAggregations._grid.mAggregations.content[0].mAggregations._grid.mAggregations.content[0].mAggregations.content.mAggregations.content.mAggregations.columns;const b=m[2].mAggregations._grid.mAggregations.content[0].mAggregations._grid.mAggregations.content[1].mAggregations.content.mAggregations.content.mAggregations.formContainers[0].mAggregations.formElements;t=m[10].mAggregations._grid.mAggregations.content[0].mAggregations._grid.mAggregations.content[0].mAggregations.content.mAggregations.items[1];var A=new Date;A.setDate(A.getDate()+5);this.getView().getModel("ui").setProperty("/minDate",A);this.getView().getModel("ui").setProperty("/visible-pdf1",true);this.getView().getModel("ui").setProperty("/visible-pdf2",false);const V=m[6].mAggregations._grid.mAggregations.content[0].mAggregations._grid.findAggregatedObjects(true,function(e){return e.isA("sap.m.DatePicker")&&e.getId().includes("dueDate")});let p=new Date;p.setDate(p.getDate()+1);V[0].setMinDate(p);if(l.value.minDelDate){var y=new Date(l.value.minDelDate);y.setDate(y.getDate()-1);this.getView().getModel("ui").setProperty("/minDueDate",y)}else{this.getView().getModel("ui").setProperty("/minDueDate",A)}V[0].bindProperty("maxDate","ui>/minDueDate");var v=l.value.result;s=v.status;const P=l.value.roles["xs.system.attributes"]["xs.rolecollections"];if(P.includes("Mahindra Sales")){t.setEditable(false);n[2].setVisible(false);g&&g[0]?.setVisible(false);if(v.status==="SO Pending"||v.status==="Approved"||v.status==="Paid"||v.status==="Rejected"||v.status==="Sent for Release"||v.status==="Waiting for Payment Confirmation"||v.status==="Credit Request"||v.status==="Credit Approved"||v.status==="Payment Confirmed"){n[0].setEnabled(false);n[2].setVisible(false);f.setVisible(false);if(v.status==="SO Pending"){c[1]._oInnerColumn.setVisible(false);b[0].setVisible(false)}else{c[1]._oInnerColumn.setVisible(true);b[0].setVisible(true)}}if(v.status==="SO Pending"){b[0].setVisible(false)}else{b[0].setVisible(true)}}else if(P.includes("Mahindra Finance")){if(r==="true"){t.setEditable(false);g&&g[0]?.setVisible(false);if(v.status==="SO Pending"){n[0].setEnabled(true);n[2].setVisible(true);f.setVisible(true);if(l.value.draftStatus){f.setVisible(false)}c[1]._oInnerColumn.setVisible(false);b[0].setVisible(false)}else if(v.status==="Sent for Release"||v.status==="Waiting for Payment Confirmation"||v.status==="Payment Confirmed"||v.status==="Paid"||v.status==="Rejected"||v.status==="Credit Request"||v.status==="Credit Approved"||v.status==="Payment Overdue"){n[0].setEnabled(false);f.setVisible(false);c[1]._oInnerColumn.setVisible(true);b[0].setVisible(true)}}else{t.setEditable(true);g&&g[0]?.setVisible(true);g&&g[0]?.addStyleClass("custom-delivery-button");n[2].setVisible(false);f.setVisible(true)}}if(v.status==="Approved"){m[1].setVisible(true);m[2].setVisible(false);m[4].setVisible(true);m[5].setVisible(false);m[6].setVisible(false);m[7].setVisible(false);m[8].setVisible(false);m[9].setVisible(true);m[10].setVisible(true)}else if(v.status==="Sent for Release"||v.status==="Rejected"||v.status==="SO Pending"){m[1].setVisible(false);m[2].setVisible(true);m[4].setVisible(true);m[5].setVisible(true);m[6].setVisible(true);m[7].setVisible(false);m[8].setVisible(false);m[9].setVisible(true);m[10].setVisible(true)}else if(v.status==="Waiting for Payment Confirmation"||v.status==="Paid"||v.status==="Credit Request"||v.status==="Payment Confirmed"||v.status==="Payment Overdue"||v.status==="Credit Approved"){m[1].setVisible(false);m[2].setVisible(true);m[4].setVisible(true);m[5].setVisible(true);m[6].setVisible(true);m[7].setVisible(false);m[8].setVisible(true);m[9].setVisible(false);m[10].setVisible(true)}if(v.status==="Paid"){m[7].setVisible(true);m[6].setVisible(false)}if(v.status==="Payment Confirmed"){this.getView().getModel("ui").setProperty("/visible-pdf2",true);m[7].setVisible(true);m[6].setVisible(false)}if(v.status==="Credit Approved"){this.getView().getModel("ui").setProperty("/visible-pdf2",true)}setTimeout(async function(){if(!n[0].getEnabled())n[0].setVisible(false)}.bind(this),800);var D=m[1].mAggregations._grid.mAggregations.content[0].mAggregations._grid.mAggregations.content[1].mAggregations.content.mAggregations.content.mAggregations.formContainers[0].mAggregations.formElements;D[4].mAggregations.fields[0].mAggregations.content.mAggregations.contentDisplay.setText(v.salesOrg);D[6].mAggregations.fields[0].mAggregations.content.mAggregations.contentDisplay.setText(v.distributionChannels);D[5].mAggregations.fields[0].mAggregations.content.mAggregations.contentDisplay.setText(v.division);D[7].mAggregations.fields[0].mAggregations.content.mAggregations.contentDisplay.setText(v.docType);var C=m[2].mAggregations._grid.mAggregations.content[0].mAggregations._grid.mAggregations.content[1].mAggregations.content.mAggregations.content.mAggregations.formContainers[0].mAggregations.formElements;C[1].mAggregations.fields[0].mAggregations.content.mAggregations.contentDisplay.setText(v.salesOrg);C[3].mAggregations.fields[0].mAggregations.content.mAggregations.contentDisplay.setText(v.distributionChannels);C[4].mAggregations.fields[0].mAggregations.content.mAggregations.contentDisplay.setText(v.division);C[5].mAggregations.fields[0].mAggregations.content.mAggregations.contentDisplay.setText(v.docType)}}},fetchData:async function(e){debugger;return new Promise((t,s)=>{jQuery.ajax({url:e,method:"GET",dataType:"json",success:function(e){t(e)},error:function(e,t,i){s(new Error(t+": "+i))}})})}})});
//# sourceMappingURL=Obj_PurchaseOrder_Page.controller.js.map