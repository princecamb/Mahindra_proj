sap.ui.define(["sap/m/MessageToast","sap/m/Dialog","sap/m/Button","sap/m/Text","sap/ui/core/BusyIndicator"],function(e,t,s,n,o){"use strict";return{REalseSO:async function(i){debugger;const r=this._view.findAggregatedObjects(true,function(e){return e.isA("sap.m.Button")&&(e.getId().includes("release-so")||e.getId().includes("Edit"))});o.show(0);const a=this._view;const c=a.getContent()[0];const l=c.getSections();const u=l[10].mAggregations._grid.mAggregations.content[0].mAggregations._grid.mAggregations.content[0].mAggregations.content.mAggregations.items[1];const g=c.getAggregation("footer");let f=i.oBinding.oElementContext;var d=f.getObject();const m=i.oModel.sServiceUrl;d.baseUrl=m;const p=m+i.sPath.slice(1)+"/purchaseToComments";const h={commentsText:d.commentsText,user:"M",IsActiveEntity:true};const w=m+i.sPath.slice(1)+"/purchaseToVehicle";const y=await S(w);let v=true;let x=true;let T=true;let b=[];var C="",A="";var E=true;const j=/^[^a-zA-Z0-9]+$/;if(!d.dueDate)v=false;if(!d.dealerCode)x=false;if(!d.commentsText){E=false;b.push("Comment is missing")}else if(j.test(d.commentsText)){E=false;b.push("Comments cannot consist solely of special characters.")}if(!v)b.push(" Due Date  is missing.");if(!x)b.push("Dealer Code is Missing");y.value.forEach(e=>{if(!e.deliveryLeadTime||!e.delDate||!e.transportMode||!e.delLocation||!e.shippingPoint){T=false}});if(!T)b.push("Delivery Details for some vehicles are missing");const D=b.join("\n");if(!T||!v||!E||!x){var O=new t({title:"Error",type:"Message",state:"Error",content:new n({text:`${D}\nPlease complete all required fields.`}),beginButton:new s({text:"OK",press:function(){O.close();o.hide()}})});O.open();return}var B=new t({title:"Confirmation",type:"Message",content:new n({text:"Do you want to send sales order for release?\nBefore sending, Please Confirm."}),beginButton:new s({text:"Confirm",press:async function(){B.close();await P()}}),endButton:new s({text:"Cancel",press:function(){B.close()}})});async function P(){debugger;o.show(0);const t=JSON.stringify(d);if(d.commentsText){const e=await M(p,h)}try{const s=d.purchaseOrderUuid;const n=m+`generateSO(data=${s})`;const i=await S(n);console.log(i);if(i.value==="success"){const s=m+`sendForRelease(data='${encodeURIComponent(t)}')`;const n=await S(s);console.log(n);if(n.value){e.show("Sent for Release!");r[0].setVisible(false);r[1].setVisible(false);g.setVisible(false);u.setValue("");o.hide()}}}catch(t){o.hide();e.show("Error while processing request")}}async function S(e){debugger;return new Promise((t,s)=>{jQuery.ajax({url:e,method:"GET",dataType:"json",success:function(e){t(e)},error:function(e,t,n){s(new Error(t+": "+n))}})})}async function M(e,t){debugger;return new Promise((s,n)=>{jQuery.ajax({url:e,method:"POST",contentType:"application/json",data:JSON.stringify(t),success:function(e){debugger;s(e)},error:function(e,t,s){n(new Error(`${t}: ${s}`))}})})}o.show(0);B.open();o.hide()}}});
//# sourceMappingURL=RealseSO.js.map