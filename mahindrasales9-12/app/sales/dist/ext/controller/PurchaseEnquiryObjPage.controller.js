sap.ui.define(["sap/ui/core/mvc/ControllerExtension","sap/m/MessageBox"],function(e,t){"use strict";var s,i;return e.extend("sales.ext.controller.PurchaseEnquiryObjPage",{override:{onInit:function(){var e=this.base.getExtensionAPI().getModel()},editFlow:{onAfterEdit:async function(e){},onAfterSave:async function(e){}},onAfterRendering:async function(e){debugger;const t=this.base.getView()},routing:{onAfterBinding:async function(){const e=this.base.getView();const t=e.getContent()[0];const s=t.getSections();const i=t.getAggregation("footer");setTimeout(()=>{const e=this.base.getView().findAggregatedObjects(true,function(e){return e.isA("sap.m.Button")&&e.getId().includes("SwitchDraftAndActiveObject")});if(e[0].getVisible()==true){if(e[0].getText()=="Saved Version"){i.setVisible(false)}else if(e[0].getText()=="Draft"){i.setVisible(true)}}},1e3)},onBeforeBinding:async function(e){debugger;const t=this.base.getView();const n=t.getContent()[0];const g=n.getSections();var o=g[3].mForwardedAggregations.subSections[0].setShowTitle(false);var r=g[1].mAggregations._grid.mAggregations.content[0].mAggregations._grid.mAggregations.content[0].mAggregations.content.mAggregations.form.mAggregations.formContainers[0].mAggregations.formElements[13].mAggregations.fields[0];let a=e.getPath().match(/purchaseEnquiryUuid=([\w-]+).*IsActiveEntity=(\w+)/);if(a){var l=a[1];var u=a[2]}var c="PE";let m=e.getModel().bindContext(`/statusFun(...)`);m.setParameter("purchaseEnquiryUuid",l);m.setParameter("state",c);await m.execute();s=m.getBoundContext().getValue();var f=s.value.priceDetails;var d=this.base.getView().mAggregations.content[0].mAggregations.sections[3].mAggregations._grid.mAggregations.content[1].mAggregations._grid.mAggregations.content[0].mAggregations.content.mAggregations.items;d[0].mAggregations.items[1].setText(f.total);d[1].mAggregations.items[1].setText(f.totaltax);d[2].mAggregations.items[1].setText(f.grandtotal);var A=s.value.result;console.log("Descriptions PE",s);const b=this.base.getView().findAggregatedObjects(true,function(e){return e.isA("sap.m.Button")&&(e.getId().includes("Edit")||e.getId().includes("send"))});const V=this.base.getView().findAggregatedObjects(true,function(e){return e.isA("sap.m.Button")&&e.getId().includes("SwitchDraftAndActiveObject")});const v=n.getAggregation("footer");var x=this.base.getView().mAggregations.content[0].mAggregations.sections[1].mAggregations._grid.mAggregations.content[0].mAggregations._grid.mAggregations.content[0].mAggregations.content.mAggregations.form.mAggregations.formContainers[0].mAggregations.formElements;const h=g[5].mAggregations._grid.mAggregations.content[0].mAggregations._grid.mAggregations.content[0].mAggregations.content.mAggregations.items[1];let _=g[3].mAggregations._grid.mAggregations.content[0]._aAggregationProxy.blocks[1].mAggregations.content.mAggregations.content.mAggregations.columns;i=s.value.result.status;var I=u==="true"||i==="Negotiation";var w=u==="false"&&i==="Request";this.getView().getModel("ui").setProperty("/text",I);this.getView().getModel("ui").setProperty("/comboBox",w);if(u==="true"){debugger;h.setEditable(false);b[1].setVisible(true);if(i==="Negotiation"){b[0].setEnabled(true);b[1].setVisible(true);v.setVisible(true);r.setVisible(true);b[0].setText("Negotiate")}else if(i==="Request"){b[0].setEnabled(true);b[1].setVisible(true);v.setVisible(true);r.setVisible(false);b[0].setText("Review Quotation")}else if(i==="In Process"){b[0].setEnabled(false);b[1].setVisible(false);v.setVisible(false);r.setVisible(true)}}else if(u==="false"){h.setEditable(true);b[1].setVisible(false);v.setVisible(true)}if(i==="Request"){r.setVisible(false);_[7]._oInnerColumn.setVisible(false);_[8]._oInnerColumn.setVisible(false);_[14]._oInnerColumn.setVisible(true)}else if(i==="In Process"){r.setVisible(true);_[7]._oInnerColumn.setVisible(true);_[8]._oInnerColumn.setVisible(false);_[14]._oInnerColumn.setVisible(true)}else if(i==="Negotiation"){r.setVisible(true);_[14]._oInnerColumn.setVisible(true);if(u==="false"){_[7]._oInnerColumn.setVisible(true);_[8]._oInnerColumn.setVisible(true)}else{_[7]._oInnerColumn.setVisible(true);_[8]._oInnerColumn.setVisible(false)}}setTimeout(async function(){if(!b[0].getEnabled())b[0].setVisible(false);x[2].mAggregations.fields[0].setText(A.salesOrg);x[3].mAggregations.fields[0].setText(A.distributionChannels);x[4].mAggregations.fields[0].setText(A.division);x[5].mAggregations.fields[0].setText(A.docType)}.bind(this),800)}}}})});
//# sourceMappingURL=PurchaseEnquiryObjPage.controller.js.map